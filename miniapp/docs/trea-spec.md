üì± TELEGRAM MINI APP ‚Äî –ü–û–õ–ù–û–ï –¢–ó –î–õ–Ø TREA

0. –ë–ê–ó–û–í–´–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø (–í–ê–ñ–ù–û)

‚ùå –ù–ï–õ–¨–ó–Ø:
- –ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—á—ë—Ç—ã —Å–∫–ª–∞–¥–∞
- –¥–µ–ª–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ—Ä–∑–∏–Ω—É
- –¥–µ–ª–∞—Ç—å ‚Äú—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π MVP –±–µ–∑ —Ä–µ–∑–µ—Ä–≤–æ–≤‚Äù

‚úÖ –ù–£–ñ–ù–û:
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Ä–≤–µ—Ä–Ω—É—é –ª–æ–≥–∏–∫—É
- Google Sheets = –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã
- —Ä–µ–∑–µ—Ä–≤ —Ç–æ–≤–∞—Ä–∞ = –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù
- Mini App = —Ç–æ–ª—å–∫–æ UI + API —Å–ª–æ–π

---

1Ô∏è‚É£ –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

1.1 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

/miniapp
 ‚îú‚îÄ /frontend      (React + Vite)
 ‚îú‚îÄ /api           (Express API)
 ‚îú‚îÄ /shared        (types, enums)
 ‚îú‚îÄ /.env
 ‚îú‚îÄ netlify.toml

---

1.2 –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (–§–ò–ö–°–ò–†–û–í–ê–ù–û)

Frontend:
- React
- Vite
- TypeScript
- Telegram WebApp SDK

Backend:
- Node.js
- Express
- JWT
- SQLite (–∏–ª–∏ InMemory ‚Üí SQLite ready)
- Google Sheets API

Deploy:
- Netlify (frontend)
- Backend ‚Äî local / VPS / Railway (–ù–ï Netlify)

---

2Ô∏è‚É£ –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø (Telegram WebApp)

2.1 Telegram Init Data

- –ü–æ–ª—É—á–∞—Ç—å initData –∏–∑ window.Telegram.WebApp
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å HMAC –ø–æ–¥–ø–∏—Å—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ò–∑–≤–ª–µ–∫–∞—Ç—å:
  - tg_id
  - username
  - first_name

2.2 JWT

POST /api/auth/verify
‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ initData
‚Üí –≤—ã–¥–∞—á–∞ JWT

–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
Authorization: Bearer <token>

---

3Ô∏è‚É£ 18+ AGE VERIFICATION

3.1 –≠–∫—Ä–∞–Ω

–≠–∫—Ä–∞–Ω –¥–æ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- –¢–µ–∫—Å—Ç: "–ú–Ω–µ –µ—Å—Ç—å 18 –ª–µ—Ç"
- –ö–Ω–æ–ø–∫–∞: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"

3.2 –õ–æ–≥–∏–∫–∞

POST /api/auth/age-verify
- —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–ª–∞–≥ age_verified = true
- –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Üí –¥–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω

---

4Ô∏è‚É£ –ö–ê–¢–ê–õ–û–ì (GOOGLE SHEETS)

4.1 –¢–∞–±–ª–∏—Ü–∞ products_

sku | name | category | brand | price | stock | active

4.2 API

GET /api/catalog
- —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å active = true
- —É—á–∏—Ç—ã–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤—ã
- –µ—Å–ª–∏ (stock - reserved) <= 0 ‚Üí –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å

4.3 –§–∏–ª—å—Ç—Ä—ã

- category
- brand
- price min/max
- discount (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –Ω–æ–≤–∏–Ω–∫–∏ (—Ñ–ª–∞–≥)

---

5Ô∏è‚É£ –ö–ê–†–¢–û–ß–ö–ê –¢–û–í–ê–†–ê

5.1 UI

- –§–æ—Ç–æ
- –ù–∞–∑–≤–∞–Ω–∏–µ
- –¶–µ–Ω–∞
- –ö–Ω–æ–ø–∫–∞ "–í –∫–æ—Ä–∑–∏–Ω—É"
- –û–ø–∏—Å–∞–Ω–∏–µ
- –ü—Ä–æ—Ñ–∏–ª—å –≤–∫—É—Å–∞ (1‚Äì5)
- –ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã

5.2 Taste Profile (–∞–¥–º–∏–Ω –∑–∞–¥–∞—ë—Ç)

sweet: 1‚Äì5
sour: 1‚Äì5
fruit: 1‚Äì5

---

6Ô∏è‚É£ –°–û–¶–ò–ê–õ–¨–ù–û–ï –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û (FAKE)

‚ö†Ô∏è –í–ê–ñ–ù–û: —ç—Ç–æ –ú–ê–†–ö–ï–¢–ò–ù–ì, –Ω–µ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥

- –°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞ (—Ä–∞–Ω–¥–æ–º 4.3‚Äì4.8)
- –ö–æ–ª-–≤–æ –æ—Ç–∑—ã–≤–æ–≤ (—Ä–∞–Ω–¥–æ–º)
- 2‚Äì3 –∫–æ—Ä–æ—Ç–∫–∏—Ö –æ—Ç–∑—ã–≤–∞ (–º–æ–∫)
- "64 –∑–∞–∫–∞–∑–∞ –∑–∞ –Ω–µ–¥–µ–ª—é" (—Ä–∞–Ω–¥–æ–º)

---

7Ô∏è‚É£ –ö–û–†–ó–ò–ù–ê (–°–ï–†–í–ï–†–ù–ê–Ø)

7.1 API

GET /api/cart
POST /api/cart/add
POST /api/cart/remove
POST /api/cart/update

7.2 –õ–æ–≥–∏–∫–∞

- –ö–æ—Ä–∑–∏–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ö–ª—é—á: tg_id + city
- –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Üí –ø–µ—Ä–µ—Å—á—ë—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

8Ô∏è‚É£ –ó–ê–ö–ê–ó (–ö–õ–Æ–ß–ï–í–û–ï)

8.1 –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞

POST /api/order/create
- —Å—Ç–∞—Ç—É—Å: buffer
- —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤—ã
- –∑–∞–ø–∏—Å–∞—Ç—å –≤ SQLite

8.2 –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

POST /api/order/confirm
- –≤—ã–±–æ—Ä –∫—É—Ä—å–µ—Ä–∞
- –≤—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏
- —Å—Ç–∞—Ç—É—Å: pending

8.3 –û–ø–ª–∞—Ç–∞

POST /api/order/payment
- —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ —Å–∫–ª–∞–¥–∞
- active = false –µ—Å–ª–∏ stock = 0
- release —Ä–µ–∑–µ—Ä–≤–æ–≤
- —Å—Ç–∞—Ç—É—Å: paid

---

9Ô∏è‚É£ GOOGLE SHEETS ‚Äî ORDERS

9.1 –¢–∞–±–ª–∏—Ü–∞ orders_

order_id
user_id
status
total_amount
courier_id
delivery_date
delivery_time
payment_method
created_at
delivered_at
items_json

---

üîü –ö–£–†–¨–ï–†–´

–¢–∞–±–ª–∏—Ü–∞ couriers_

courier_id
name
tg_id
active
time_from
time_to

- Mini App —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç
- –í—ã–±–æ—Ä –∫—É—Ä—å–µ—Ä–∞ –∏–∑ active

---

1Ô∏è‚É£1Ô∏è‚É£ HOME PAGE (UI)

- –ë–∞–Ω–Ω–µ—Ä—ã (–∫–∞—Ä—É—Å–µ–ª—å)
- –ö–Ω–æ–ø–∫–∏:
  - –ö–∞—Ç–∞–ª–æ–≥
  - –ê–∫—Ü–∏–∏
  - –ö–æ—Ä–∑–∏–Ω–∞
  - –ë–æ–Ω—É—Å—ã
- –ë–ª–æ–∫–∏:
  - –•–∏—Ç—ã –Ω–µ–¥–µ–ª–∏
  - –ù–æ–≤–∏–Ω–∫–∏
- –ü–æ–∏—Å–∫

---

1Ô∏è‚É£2Ô∏è‚É£ –ü–†–û–§–ò–õ–¨

- –ë–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤
- –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞

---

1Ô∏è‚É£3Ô∏è‚É£ –ë–û–ù–£–°–´ / –†–ï–§–ï–†–ê–õ–ö–ê

- –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
- –°–ø–∏—Å–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
- –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

---

1Ô∏è‚É£4Ô∏è‚É£ –ê–ù–ê–õ–ò–¢–ò–ö–ê (EVENTS)

POST /api/analytics/event

–°–æ–±—ã—Ç–∏—è:
- view_product
- add_to_cart
- checkout
- order_paid
- delivered

---

1Ô∏è‚É£5Ô∏è‚É£ –î–ï–ü–õ–û–ô

Frontend (Netlify)

- build: npm run build
- publish: /dist
- ENV:
  VITE_API_URL
  VITE_CURRENCY_SYMBOL

Backend

- Express
- PORT 8080
- CORS —Ç–æ–ª—å–∫–æ —Å frontend URL

---

1Ô∏è‚É£6Ô∏è‚É£ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò (DONE)

‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
- –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram
- –ø—Ä–æ–π—Ç–∏ 18+
- —É–≤–∏–¥–µ—Ç—å –∫–∞—Ç–∞–ª–æ–≥
- –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
- –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
- –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä
- –æ–ø–ª–∞—Ç–∏—Ç—å
- —Ç–æ–≤–∞—Ä –∏—Å—á–µ–∑–∞–µ—Ç –ø—Ä–∏ 0 stock

‚ùå –ù–ï –î–û–ü–£–°–ö–ê–ï–¢–°–Ø:
- –¥–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ
- –ø—Ä–æ–¥–∞–∂–∞ –±–µ–∑ —Ä–µ–∑–µ—Ä–≤–∞
- —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω —Å Google Sheets

---

üìå –§–ò–ù–ê–õ

–≠—Ç–æ –ù–ï —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç.
–≠—Ç–æ –∫–æ–ø–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ª–æ–≥–∏–∫–∏ –±–æ—Ç–∞, –æ–±—ë—Ä–Ω—É—Ç–∞—è –≤ Mini App UI.

